<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlassSpace - Notes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></link>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #e0f2fe 100%);
            color: #1e293b;
            height: 100vh;
            overflow: hidden;
        }

        .glass {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.7);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);
        }

        /* Markdown Styling */
        .markdown-body { line-height: 1.6; color: #334155; }
        .markdown-body h1 { font-size: 2em; font-weight: 800; color: #0f172a; margin-bottom: 0.5em; border-bottom: 2px solid rgba(0,0,0,0.05); }
        .markdown-body h2 { font-size: 1.5em; font-weight: 700; color: #1e293b; margin-top: 1em; }
        .markdown-body p { margin-bottom: 1em; }
        .markdown-body ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 1em; }
        
        #note-content, #note-preview {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            padding: 3rem;
            overflow-y: auto;
            border: none;
            outline: none;
            background: transparent;
        }
        #note-content { 
            z-index: 10; 
            font-family: 'Fira Code', monospace; 
            font-size: 15px; 
            line-height: 1.8;
            color: #334155;
            resize: none;
        }
        #note-preview { z-index: 20; }
        
        .sidebar-item {
            transition: all 0.2s;
        }
        .sidebar-item.active {
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            color: #1e293b;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="glass w-full h-[90vh] max-w-7xl mx-auto rounded-[2.5rem] overflow-hidden flex shadow-2xl">
        
        <!-- SIDEBAR -->
        <div class="w-80 glass border-r border-white/40 flex flex-col bg-white/20">
            <div class="p-6 space-y-4">
                <div class="flex items-center justify-between">
                    <h1 class="text-xl font-black text-slate-800 tracking-tight">NOTES</h1>
                    <button onclick="createNewNote()" class="p-2.5 rounded-xl bg-amber-500 text-white hover:scale-110 transition shadow-lg shadow-amber-500/20">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
                <div class="relative">
                    <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"></i>
                    <input type="text" id="search" placeholder="Search notes..." class="w-full bg-white/40 border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-2 focus:ring-amber-500/20 outline-none">
                </div>
            </div>

            <div id="list" class="flex-1 overflow-y-auto px-4 pb-4 space-y-1">
                <!-- Notes list -->
            </div>

            <div class="p-6 border-t border-white/20">
                <a href="index.html" class="text-xs font-bold text-slate-400 hover:text-slate-600 flex items-center gap-2">
                    <i class="fa-solid fa-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>

        <!-- EDITOR -->
        <div class="flex-1 flex flex-col relative bg-white/10">
            <div id="empty-state" class="absolute inset-0 flex flex-col items-center justify-center text-slate-400 z-50 pointer-events-none opacity-60">
                <i class="fa-solid fa-pen-nib text-5xl mb-4"></i>
                <p class="font-medium">Select a note to start writing.</p>
            </div>

            <div id="editor-view" class="hidden flex-1 flex flex-col h-full">
                <div class="px-10 py-6 border-b border-white/30 flex justify-between items-center bg-white/20 backdrop-blur-md z-40">
                    <input type="text" id="note-title" placeholder="Untitled Note" class="bg-transparent text-2xl font-black text-slate-800 focus:outline-none w-full">
                    <div id="status-chip" class="px-3 py-1 rounded-full bg-amber-100 text-amber-700 text-[10px] font-black uppercase tracking-widest whitespace-nowrap">
                        Preview Mode
                    </div>
                </div>
                
                <div class="flex-1 relative overflow-hidden">
                    <textarea id="note-content" class="hidden" spellcheck="false"></textarea>
                    <div id="note-preview" class="markdown-body"></div>
                </div>

                <div class="p-6 border-t border-white/30 flex justify-between items-center bg-white/20 z-40">
                    <button onclick="toggleView()" class="flex items-center gap-2 px-5 py-2.5 rounded-2xl bg-slate-800 text-white text-xs font-bold hover:bg-black transition-all shadow-lg shadow-slate-200">
                        <i class="fa-solid fa-code"></i> Toggle Edit/Preview
                    </button>
                    <button onclick="deleteActive()" class="text-slate-400 hover:text-red-500 transition-colors p-2">
                        <i class="fa-solid fa-trash-can"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_ID = 'glass_notes_v2';
        let state = {
            notes: [],
            activeId: null,
            isEditing: false
        };

        function loadData() {
            const raw = localStorage.getItem(STORAGE_ID);
            if (raw) state.notes = JSON.parse(raw);
            renderSidebar();
        }

        function saveData() {
            localStorage.setItem(STORAGE_ID, JSON.stringify(state.notes));
        }

        function renderSidebar() {
            const list = document.getElementById('list');
            list.innerHTML = '';
            state.notes.forEach(note => {
                const isActive = note.id === state.activeId;
                const el = document.createElement('div');
                el.className = `sidebar-item p-4 rounded-xl cursor-pointer text-sm font-bold truncate flex items-center gap-3 ${isActive ? 'active' : 'text-slate-500 hover:bg-white/40'}`;
                el.innerHTML = `<i class="fa-regular fa-file-lines text-amber-500 opacity-60"></i> ${note.title || 'Untitled Note'}`;
                el.onclick = () => selectNote(note.id);
                list.appendChild(el);
            });
        }

        function createNewNote() {
            const newNote = { id: Date.now().toString(), title: '', content: '' };
            state.notes.unshift(newNote);
            saveData();
            selectNote(newNote.id);
            startEditing();
        }

        function selectNote(id) {
            state.activeId = id;
            const note = state.notes.find(n => n.id === id);
            if (!note) return;

            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('editor-view').classList.remove('hidden');
            document.getElementById('note-title').value = note.title;
            document.getElementById('note-content').value = note.content;
            
            state.isEditing = false;
            updateUI();
            renderSidebar();

            document.getElementById('note-title').oninput = (e) => {
                note.title = e.target.value;
                saveData();
                renderSidebar();
            };
            document.getElementById('note-content').oninput = (e) => {
                note.content = e.target.value;
                saveData();
            };
        }

        function updateUI() {
            const input = document.getElementById('note-content');
            const preview = document.getElementById('note-preview');
            const chip = document.getElementById('status-chip');

            if (state.isEditing) {
                input.classList.remove('hidden');
                preview.classList.add('hidden');
                input.focus();
                chip.innerText = "Editing Mode";
                chip.className = "px-3 py-1 rounded-full bg-slate-100 text-slate-500 text-[10px] font-black uppercase tracking-widest";
            } else {
                input.classList.add('hidden');
                preview.classList.remove('hidden');
                preview.innerHTML = marked.parse(input.value || '*Click to write something...*');
                chip.innerText = "Preview Mode";
                chip.className = "px-3 py-1 rounded-full bg-amber-100 text-amber-700 text-[10px] font-black uppercase tracking-widest";
            }
        }

        function toggleView() {
            state.isEditing = !state.isEditing;
            updateUI();
        }

        function startEditing() { state.isEditing = true; updateUI(); }

        function deleteActive() {
            if(confirm('Delete this note?')) {
                state.notes = state.notes.filter(n => n.id !== state.activeId);
                state.activeId = null;
                saveData();
                renderSidebar();
                document.getElementById('editor-view').classList.add('hidden');
                document.getElementById('empty-state').classList.remove('hidden');
            }
        }

        document.getElementById('note-preview').onclick = startEditing;
        loadData();
    </script>
</body>
</html>
