<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlassSpace - Projects</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e0f7e9 0%, #f0fdf4 100%);
            color: #4a5568;
            height: 100vh;
            overflow: hidden;
        }
        .glass {
            background: rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.65);
            box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(8px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .glass-input {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(4px);
        }
        .glass-input:focus { outline: none; border-color: #86efac; background: rgba(255, 255, 255, 0.8); }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: rgba(134, 239, 172, 0.8); border-radius: 4px; }
    </style>
</head>
<body class="flex items-center justify-center p-4 sm:p-8">

    <div class="glass w-full max-w-7xl h-[90vh] flex flex-col rounded-2xl overflow-hidden relative">
        <!-- Header -->
        <div class="h-20 border-b border-white/50 flex items-center justify-between px-8 bg-white/20">
            <div class="flex items-center gap-4">
                <a href="index.html" class="w-10 h-10 rounded-xl bg-white/50 hover:bg-white flex items-center justify-center text-gray-600 transition shadow-sm">
                    <i class="fa-solid fa-arrow-left"></i>
                </a>
                <h1 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                    <i class="fa-solid fa-rocket text-blue-500"></i> Projects
                </h1>
            </div>
            <button onclick="openProjectModal()" class="bg-green-500 hover:bg-green-600 text-white px-5 py-2 rounded-xl shadow-lg shadow-green-200 transition flex items-center gap-2 text-sm font-medium">
                <i class="fa-solid fa-plus"></i> Create Project
            </button>
        </div>

        <!-- Content -->
        <div class="flex-1 p-8 overflow-y-auto bg-white/30">
            <div id="projects-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards injected here -->
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="project-modal" class="fixed inset-0 bg-black/20 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="glass-panel w-full max-w-2xl max-h-[90vh] overflow-y-auto flex flex-col animate-fade-in">
            <div class="p-6 border-b border-white/50 flex justify-between items-center bg-white/60 sticky top-0 backdrop-blur-md">
                <h3 id="modal-title" class="text-xl font-bold text-gray-800">New Project</h3>
                <button onclick="closeProjectModal()" class="text-gray-400 hover:text-gray-600"><i class="fa-solid fa-times text-xl"></i></button>
            </div>
            <div class="p-6 space-y-4">
                <input type="hidden" id="p-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="col-span-2">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Name</label>
                        <input type="text" id="p-name" class="w-full glass-input px-4 py-2 rounded-lg mt-1" placeholder="Project Name">
                    </div>
                    <div class="col-span-2">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Description</label>
                        <textarea id="p-desc" class="w-full glass-input px-4 py-2 rounded-lg mt-1 h-20" placeholder="Details..."></textarea>
                    </div>
                    <div>
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Type</label>
                        <select id="p-type" class="w-full glass-input px-4 py-2 rounded-lg mt-1">
                            <option>Discord Bot</option><option>Website</option><option>Both</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Status</label>
                        <select id="p-status" class="w-full glass-input px-4 py-2 rounded-lg mt-1">
                            <option>In Development</option><option>Online</option><option>Stopped</option><option>Being Fixed</option>
                        </select>
                    </div>
                    <div class="col-span-2">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Users (IDs)</label>
                        <input type="text" id="p-users" class="w-full glass-input px-4 py-2 rounded-lg mt-1" placeholder="e.g. 123456789">
                    </div>
                    <div class="col-span-2">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Purpose</label>
                        <input type="text" id="p-purpose" class="w-full glass-input px-4 py-2 rounded-lg mt-1" placeholder="e.g. Moderation">
                    </div>
                </div>
                <div class="pt-4 border-t border-white/50">
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-sm font-bold text-gray-700">Extras</label>
                        <button onclick="addExtraField()" class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded hover:bg-green-200">
                            <i class="fa-solid fa-plus"></i> Add
                        </button>
                    </div>
                    <div id="p-extras-container" class="space-y-3"></div>
                </div>
            </div>
            <div class="p-6 border-t border-white/50 bg-white/40 flex justify-between items-center">
                <button id="btn-delete" onclick="deleteProject()" class="text-red-500 hover:text-red-700 text-sm hidden font-medium">Delete</button>
                <div class="flex gap-2 ml-auto">
                    <button onclick="closeProjectModal()" class="px-4 py-2 rounded-lg hover:bg-white/50">Cancel</button>
                    <button onclick="saveProject()" class="px-6 py-2 rounded-lg bg-green-500 text-white shadow-lg shadow-green-200">Save</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DB_KEY = 'glass_workspace_db_v1';
        let projects = [];

        function init() {
            const data = JSON.parse(localStorage.getItem(DB_KEY) || '{"projects":[]}');
            projects = data.projects || [];
            render();
        }

        function save() {
            const data = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
            data.projects = projects;
            localStorage.setItem(DB_KEY, JSON.stringify(data));
        }

        function render() {
            const container = document.getElementById('projects-list');
            container.innerHTML = '';
            if(projects.length === 0) {
                container.innerHTML = `<div class="col-span-full text-center text-gray-400 py-10 italic">No projects yet. Create one!</div>`;
                return;
            }
            projects.forEach(p => {
                const colors = { 'In Development': 'bg-blue-100 text-blue-700', 'Online': 'bg-green-100 text-green-700', 'Stopped': 'bg-red-100 text-red-700', 'Being Fixed': 'bg-orange-100 text-orange-700' };
                const badge = colors[p.status] || 'bg-gray-100 text-gray-700';
                container.innerHTML += `
                    <div onclick="openProjectModal('${p.id}')" class="glass-panel p-5 cursor-pointer hover:scale-[1.02] transition-transform">
                        <div class="flex justify-between items-start mb-3">
                            <span class="text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide ${badge}">${p.status}</span>
                            <i class="fa-solid fa-chevron-right text-gray-300 text-xs"></i>
                        </div>
                        <h3 class="font-bold text-gray-800 text-lg">${p.name}</h3>
                        <p class="text-xs text-gray-500 mb-2 uppercase font-semibold tracking-wider">${p.type}</p>
                        <p class="text-sm text-gray-600 line-clamp-2">${p.desc}</p>
                    </div>
                `;
            });
        }

        function openProjectModal(id) {
            const modal = document.getElementById('project-modal');
            const container = document.getElementById('p-extras-container');
            container.innerHTML = '';
            document.getElementById('p-id').value = '';
            document.getElementById('p-name').value = '';
            document.getElementById('p-desc').value = '';
            document.getElementById('p-users').value = '';
            document.getElementById('p-purpose').value = '';
            document.getElementById('btn-delete').classList.add('hidden');

            if (id) {
                const p = projects.find(x => x.id === id);
                if (p) {
                    document.getElementById('p-id').value = p.id;
                    document.getElementById('p-name').value = p.name;
                    document.getElementById('p-desc').value = p.desc;
                    document.getElementById('p-type').value = p.type;
                    document.getElementById('p-status').value = p.status;
                    document.getElementById('p-users').value = p.users;
                    document.getElementById('p-purpose').value = p.purpose;
                    document.getElementById('btn-delete').classList.remove('hidden');
                    if(p.extras) p.extras.forEach(e => addExtraField(e.title, e.desc));
                }
            }
            modal.classList.remove('hidden');
        }

        function closeProjectModal() { document.getElementById('project-modal').classList.add('hidden'); }

        function addExtraField(t='', d='') {
            const div = document.createElement('div');
            div.className = 'glass p-3 rounded-lg relative group';
            div.innerHTML = `
                <button onclick="this.parentElement.remove()" class="absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition"><i class="fa-solid fa-trash"></i></button>
                <input class="extra-t w-full bg-transparent border-b border-gray-300 focus:border-green-400 outline-none text-sm font-bold mb-1" placeholder="Title" value="${t}">
                <input class="extra-d w-full bg-transparent outline-none text-sm text-gray-600" placeholder="Description" value="${d}">
            `;
            document.getElementById('p-extras-container').appendChild(div);
        }

        function saveProject() {
            const id = document.getElementById('p-id').value;
            const extras = [];
            document.querySelectorAll('#p-extras-container > div').forEach(div => {
                extras.push({ title: div.querySelector('.extra-t').value, desc: div.querySelector('.extra-d').value });
            });
            const obj = {
                id: id || Date.now().toString(),
                name: document.getElementById('p-name').value,
                desc: document.getElementById('p-desc').value,
                type: document.getElementById('p-type').value,
                status: document.getElementById('p-status').value,
                users: document.getElementById('p-users').value,
                purpose: document.getElementById('p-purpose').value,
                extras: extras
            };
            if (id) {
                const idx = projects.findIndex(x => x.id === id);
                if(idx !== -1) projects[idx] = obj;
            } else projects.push(obj);
            save(); render(); closeProjectModal();
        }

        function deleteProject() {
            const id = document.getElementById('p-id').value;
            if (confirm('Delete project?')) {
                projects = projects.filter(x => x.id !== id);
                save(); render(); closeProjectModal();
            }
        }

        init();
    </script>
</body>
</html>
